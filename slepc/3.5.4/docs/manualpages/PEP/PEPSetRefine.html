<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML3.2 EN">
<HTML>
<HEAD> <link rel="canonical" href="http://slepc.upv.es/documentation/current/docs/manualpages/PEP/PEPSetRefine.html" />
<META NAME="GENERATOR" CONTENT="DOCTEXT">
<link rel="stylesheet" href="/slepc/slepc.css" type="text/css">
<TITLE>PEPSetRefine</TITLE>
</HEAD>
<BODY BGCOLOR="FFFFFF">
   <div id="version" align=right><b>slepc-3.5.4 2015-05-25</b></div>
   <div id="bugreport" align=right><a href="mailto:slepc-maint@upv.es?subject=Typo or Error in Documentation &body=Please describe the typo or error in the documentation: slepc-3.5.4 v3.5.4 docs/manualpages/PEP/PEPSetRefine.html "><small>Report Typos and Errors</small></a></div>

<H1>PEPSetRefine</H1>
Specifies the refinement type (and options) to be used after the solve. 
<H3><FONT COLOR="#883300">Synopsis</FONT></H3>
<PRE>
#include "slepcpep.h" 
PetscErrorCode PEPSetRefine(PEP pep,PEPRefine refine,PetscInt npart,PetscReal tol,PetscInt its,PetscBool schur)
</PRE>
Logically Collective on <A HREF="../PEP/PEP.html#PEP">PEP</A>
<P>
<H3><FONT COLOR="#883300">Input Parameters</FONT></H3>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>pep    </B></TD><TD> - the polynomial eigensolver context
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>refine </B></TD><TD> - refinement type
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>npart  </B></TD><TD> - number of partitions of the communicator
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>tol    </B></TD><TD> - the convergence tolerance
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>its    </B></TD><TD> - maximum number of refinement iterations
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>schur  </B></TD><TD> - boolean flag to activate the Schur complement approach
</TD></TR></TABLE>
<P>
<H3><FONT COLOR="#883300">Options Database Keys</FONT></H3>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-pep_refine &lt;type&gt; </B></TD><TD> - refinement type, one of &lt;none,simple,multiple&gt;
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-pep_refine_partitions &lt;n&gt; </B></TD><TD> - the number of partitions
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-pep_refine_tol &lt;tol&gt; </B></TD><TD> - the tolerance
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-pep_refine_its &lt;its&gt; </B></TD><TD> - number of iterations
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-pep_refine_schur </B></TD><TD> - to set the Schur complement approach
</TD></TR></TABLE>
<P>
<H3><FONT COLOR="#883300">Notes</FONT></H3>
By default, iterative refinement is disabled, since it may be very
costly. There are two possible refinement strategies: simple and multiple.
The simple approach performs iterative refinement on each of the
converged eigenpairs individually, whereas the multiple strategy works
with the invariant pair as a whole, refining all eigenpairs simultaneously.
The latter may be required for the case of multiple eigenvalues.
<P>
In some cases, especially when using direct solvers within the
iterative refinement method, it may be helpful for improved scalability
to split the communicator in several partitions. The npart parameter
indicates how many partitions to use (defaults to 1).
<P>
The tol and its parameters specify the stopping criterion. In the simple
method, refinement continues until the residual of each eigenpair is
below the tolerance (tol defaults to the <A HREF="../PEP/PEP.html#PEP">PEP</A> tol, but may be set to a
different value). In contrast, the multiple method simply performs its
refinement iterations (just one by default).
<P>
The schur flag is used to change the way in which linear systems are
solved, so that a Schur complement approach is used instead of explicitly
building the coefficient matrix.
<P>

<P>
<H3><FONT COLOR="#883300">See Also</FONT></H3>
 <A HREF="../PEP/PEPGetRefine.html#PEPGetRefine">PEPGetRefine</A>()
<BR><P><B><FONT COLOR="#883300">Location: </FONT></B><A HREF="../../../src/pep/interface/pepopts.c.html#PEPSetRefine">src/pep/interface/pepopts.c</A>
<BR><A HREF="./index.html">Index of all PEP routines</A>
<BR><A HREF="../../index.html">Table of Contents for all manual pages</A>
<BR><A HREF="../singleindex.html">Index of all manual pages</A>
</BODY></HTML>
